/**
 * Hilo 1.0.0 for cmd
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
define(function(e,t,r){var s=e("hilo/core/Hilo"),i=e("hilo/core/Class"),a=e("hilo/view/View"),n=e("hilo/view/Drawable"),h=i.create({Extends:a,constructor:function(e){e=e||{},this.id=this.id||e.id||s.getUid("Sprite"),h.superclass.constructor.call(this,e),this._frames=[],this._frameNames={},this.drawable=new n,e.frames&&this.addFrame(e.frames)},_frames:null,_frameNames:null,_frameElapsed:0,_firstRender:!0,paused:!1,loop:!0,timeBased:!1,interval:1,currentFrame:0,getNumFrames:function(){return this._frames?this._frames.length:0},addFrame:function(e,t){var r=null!=t?t:this._frames.length;if(e instanceof Array)for(var s=0,i=e.length;i>s;s++)this.setFrame(e[s],r+s);else this.setFrame(e,r);return this},setFrame:function(e,t){var r=this._frames,s=r.length;return t=0>t?0:t>s?s:t,r[t]=e,e.name&&(this._frameNames[e.name]=e),(0!=t||this.width)&&this.height||(this.width=e.rect[2],this.height=e.rect[3]),this},getFrame:function(e){if("number"==typeof e){var t=this._frames;return 0>e||e>=t.length?null:t[e]}return this._frameNames[e]},getFrameIndex:function(e){var t=this._frames,r=t.length,s=-1;if("number"==typeof e)s=e;else{var i="string"==typeof e?this._frameNames[e]:e;if(i)for(var a=0;r>a;a++)if(i===t[a]){s=a;break}}return s},play:function(){return this.paused=!1,this},stop:function(){return this.paused=!0,this},"goto":function(e,t){var r=this._frames.length,s=this.getFrameIndex(e);return this.currentFrame=0>s?0:s>=r?r-1:s,this.paused=t,this._firstRender=!0,this},_render:function(e,t){var r,s=this.currentFrame;if(this._firstRender?(r=s,this._firstRender=!1):r=this._nextFrame(t),r!=s){this.currentFrame=r;var i=this._frames[r].callback;i&&i.call(this)}this.onEnterFrame&&this.onEnterFrame(r),this.drawable.init(this._frames[r]),h.superclass._render.call(this,e,t)},_nextFrame:function(e){var t=this._frames,r=t.length,s=this.currentFrame,i=t[s],a=i.duration||this.interval,n=this._frameElapsed,h=0!=s||this.drawable?n+(this.timeBased?e:1):0;return n=this._frameElapsed=a>h?h:0,(i.stop||!this.loop&&s>=r-1)&&this.stop(),this.paused||0!=n||(null!=i.next?s=this.getFrameIndex(i.next):s>=r-1?s=0:this.drawable&&s++),s},setFrameCallback:function(e,t){return e=this.getFrame(e),e&&(e.callback=t),this},onEnterFrame:null});return h});