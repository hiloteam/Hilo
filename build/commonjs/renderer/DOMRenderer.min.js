/**
 * Hilo 1.0.1 for commonjs
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
var Class=require("../core/Class"),Hilo=require("../core/Hilo"),Renderer=require("./Renderer"),Drawable=require("../view/Drawable"),DOMRenderer=function(){function e(e,t){var r=e.tagName||"div",a=t.image,i=e.width||a&&a.width,n=e.height||a&&a.height,l=Hilo.createElement(r),d=l.style;if(e.id&&(l.id=e.id),d.position="absolute",d.left=(e.left||0)+"px",d.top=(e.top||0)+"px",d.width=i+"px",d.height=n+"px","canvas"==r){if(l.width=i,l.height=n,a){var o=l.getContext("2d"),s=t.rect||[0,0,i,n];o.drawImage(a,s[0],s[1],s[2],s[3],e.x||0,e.y||0,e.width||s[2],e.height||s[3])}}else if(d.opacity=void 0!=e.alpha?e.alpha:1,(e===this.stage||e.clipChildren)&&(d.overflow="hidden"),a&&a.src){d.backgroundImage="url("+a.src+")";var h=e.rectX||0,c=e.rectY||0;d.backgroundPosition=-h+"px "+-c+"px"}return l}return Class.create({Extends:Renderer,constructor:function(e){DOMRenderer.superclass.constructor.call(this,e)},renderType:"dom",startDraw:function(t){var r=t.drawable=t.drawable||new Drawable;return r.domElement=r.domElement||e(t,r),!0},draw:function(e){var t=e.parent,r=e.drawable.domElement,a=r.parentNode;if(t){var i=t.drawable.domElement;if(i!=a&&i.appendChild(r),!e.width&&!e.height){var n=e.drawable.rect;n&&(n[2]||n[3])&&(e.width=n[2],e.height=n[3])}}else e!==this.stage||a||(r.style.overflow="hidden",this.canvas.appendChild(r))},transform:function(e){if(Hilo.setElementStyleByView(e),e===this.stage){var t=this.canvas.style,r=e._scaleX,a=e._scaleY,i=e.scaleX,n=e.scaleY;(!r&&1!=i||r&&r!=i)&&(e._scaleX=i,t.width=i*e.width+"px"),(!a&&1!=n||a&&a!=n)&&(e._scaleY=n,t.height=n*e.height+"px")}},remove:function(e){var t=e.drawable,r=t&&t.domElement;if(r){var a=r.parentNode;a&&a.removeChild(r)}},hide:function(e){var t=e.drawable&&e.drawable.domElement;t&&(t.style.display="none")},resize:function(e,t){var r=this.canvas.style;r.width=e+"px",r.height=t+"px","absolute"!=r.position&&(r.position="relative")}})}();module.exports=DOMRenderer;