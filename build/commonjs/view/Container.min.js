/**
 * Hilo 1.0.1 for commonjs
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
var Hilo=require("../core/Hilo"),Class=require("../core/Class"),View=require("./View"),Container=Class.create({Extends:View,constructor:function(e){e=e||{},this.id=this.id||e.id||Hilo.getUid("Container"),Container.superclass.constructor.call(this,e),this.children?this._updateChildren():this.children=[]},children:null,pointerChildren:!0,clipChildren:!1,getNumChildren:function(){return this.children.length},addChildAt:function(e,r){var i=this.children,t=i.length,n=e.parent;r=r<0?0:r>t?t:r;var h=this.getChildIndex(e);if(h==r)return this;if(h>=0?(i.splice(h,1),r=r==t?t-1:r):n&&n.removeChild(e),i.splice(r,0,e),h<0)this._updateChildren(r);else{var l=h<r?h:r,d=h<r?r:h;this._updateChildren(l,d+1)}return this},addChild:function(e){for(var r=this.children.length,i=arguments,t=0,n=i.length;t<n;t++)this.addChildAt(i[t],r+t);return this},removeChildAt:function(e){var r=this.children;if(e<0||e>=r.length)return null;var i=r[e];if(i){if(!i.__renderer)for(var t=i;t=t.parent;){if(t.renderer){i.__renderer=t.renderer;break}if(t.__renderer){i.__renderer=t.__renderer;break}}i.__renderer&&i.__renderer.remove(i),i.parent=null,i.depth=-1}return r.splice(e,1),this._updateChildren(e),i},removeChild:function(e){return this.removeChildAt(this.getChildIndex(e))},removeChildById:function(e){for(var r,i=this.children,t=0,n=i.length;t<n;t++)if(r=i[t],r.id===e)return this.removeChildAt(t),r;return null},removeAllChildren:function(){for(;this.children.length;)this.removeChildAt(0);return this},getChildAt:function(e){var r=this.children;return e<0||e>=r.length?null:r[e]},getChildById:function(e){for(var r,i=this.children,t=0,n=i.length;t<n;t++)if(r=i[t],r.id===e)return r;return null},getChildIndex:function(e){return this.children.indexOf(e)},setChildIndex:function(e,r){var i=this.children,t=i.indexOf(e);if(t>=0&&t!=r){var n=i.length;r=r<0?0:r>=n?n-1:r,i.splice(t,1),i.splice(r,0,e),this._updateChildren()}return this},swapChildren:function(e,r){var i=this.children,t=this.getChildIndex(e),n=this.getChildIndex(r);e.depth=n,i[n]=e,r.depth=t,i[t]=r},swapChildrenAt:function(e,r){var i=this.children,t=this.getChildAt(e),n=this.getChildAt(r);t.depth=r,i[r]=t,n.depth=e,i[e]=n},sortChildren:function(e){var r=e,i=this.children;if("string"==typeof r){var t=r;r=function(e,r){return r[t]-e[t]}}i.sort(r),this._updateChildren()},_updateChildren:function(e,r){for(var i,t=this.children,e=e||0,r=r||t.length,n=e;n<r;n++)i=t[n],i.depth=n+1,i.parent=this},contains:function(e){for(;e=e.parent;)if(e===this)return!0;return!1},getViewAtPoint:function(e,r,i,t,n){for(var h,l,d=t?[]:null,s=this.children,u=s.length-1;u>=0;u--)if(h=s[u],!(!h||!h.visible||h.alpha<=0||n&&!h.pointerEnabled))if(h.children&&h.children.length&&(!n||h.pointerChildren)&&(l=h.getViewAtPoint(e,r,i,t,n)),l){if(!t)return l;l.length&&(d=d.concat(l))}else if(h.hitTestPoint(e,r,i)){if(!t)return h;d.push(h)}return t&&d.length?d:null},render:function(e,r){Container.superclass.render.call(this,e,r);var i,t,n,h=this.children.slice(0);for(i=0,t=h.length;i<t;i++)n=h[i],n.parent===this&&n._render(e,r)}});module.exports=Container;