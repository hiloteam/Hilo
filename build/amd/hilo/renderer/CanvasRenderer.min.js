/**
 * Hilo 1.0.0 for amd
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
define("hilo/renderer/CanvasRenderer",["hilo/core/Class","hilo/core/Hilo","hilo/renderer/Renderer"],function(e,t,a){var r=e.create({Extends:a,constructor:function(e){r.superclass.constructor.call(this,e),this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(e){return e.visible&&e.alpha>0?(e===this.stage&&this.context.clearRect(0,0,e.width,e.height),this.context.save(),!0):!1},draw:function(e){var t=this.context,a=e.width,r=e.height,i=e.background;i&&(t.fillStyle=i,t.fillRect(0,0,a,r));var n=e.drawable,s=n&&n.image;if(s){var c=n.rect,h=c[2],l=c[3],o=c[4],d=c[5];if(!h||!l)return;a||r||(a=e.width=h,r=e.height=l),(o||d)&&t.translate(o-.5*h,d-.5*l),t.drawImage(s,c[0],c[1],h,l,0,0,a,r)}},endDraw:function(e){this.context.restore()},transform:function(e){var a=e.drawable;if(a&&a.domElement)return void t.setElementStyleByView(e);var r=this.context,i=e.scaleX,n=e.scaleY;if(e===this.stage){var s=this.canvas.style,c=e._scaleX,h=e._scaleY;(!c&&1!=i||c&&c!=i)&&(e._scaleX=i,s.width=i*e.width+"px"),(!h&&1!=n||h&&h!=n)&&(e._scaleY=n,s.height=n*e.height+"px")}else{var l=e.x,o=e.y,d=e.pivotX,v=e.pivotY,f=e.rotation%360,u=e.mask;u&&(u._render(this),r.clip());var g=e.align;if(g)if("function"==typeof g)e.align();else{var w=e.parent;if(w){var b=e.width,p=e.height,x=w.width,m=w.height;switch(g){case"TL":l=0,o=0;break;case"T":l=x-b>>1,o=0;break;case"TR":l=x-b,o=0;break;case"L":l=0,o=m-p>>1;break;case"C":l=x-b>>1,o=m-p>>1;break;case"R":l=x-b,o=m-p>>1;break;case"BL":l=0,o=m-p;break;case"B":l=x-b>>1,o=m-p;break;case"BR":l=x-b,o=m-p}}}0==l&&0==o||r.translate(l,o),0!=f&&r.rotate(f*Math.PI/180),1==i&&1==n||r.scale(i,n),0==d&&0==v||r.translate(-d,-v)}e.alpha>0&&(r.globalAlpha*=e.alpha)},remove:function(e){var t=e.drawable,a=t&&t.domElement;if(a){var r=a.parentNode;r&&r.removeChild(a)}},clear:function(e,t,a,r){this.context.clearRect(e,t,a,r)},resize:function(e,t){this.canvas.width=e,this.canvas.height=t}});return r});