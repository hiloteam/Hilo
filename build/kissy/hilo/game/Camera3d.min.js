/**
 * Hilo 1.0.0 for kissy
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
KISSY.add("hilo/game/Camera3d",function(t,i,o){var n=function(){function t(t,i,o,n,r){return{x:t,y:i*n-o*r,z:i*r+o*n}}function n(t,i,o,n,r){return{x:t*n-o*r,y:i,z:t*r+o*n}}function r(t,i,o,n,r){return{x:t*n-i*r,y:t*r+i*n,z:o}}var s=Math.PI/180,a=o.create({constructor:function(t){t.x=t.x||0,t.y=t.y||0,t.z=t.z||0,t.rotationX=t.rotationX||0,t.rotationY=t.rotationY||0,t.rotationZ=t.rotationZ||0,i.copy(this,t)},translate:function(t,i,o){this.tx=t,this.ty=i,this.tz=o},rotateX:function(t){this.rotationX=t},rotateY:function(t){this.rotationY=t},rotateZ:function(t){this.rotationZ=t},project:function(i,o){var a=this.rotationX*s,h=this.rotationY*s,c=this.rotationZ*s,e=Math.cos(a),u=Math.sin(a),f=Math.cos(h),z=Math.sin(h),y=Math.cos(c),x=Math.sin(c),l=i.x-this.x,v=i.y-this.y,M=i.z-this.z,Y=r(l,v,M,y,x);Y=n(Y.x,Y.y,Y.z,f,z),Y=t(Y.x,Y.y,Y.z,e,u),this.tx&&(Y.x-=this.tx),this.ty&&(Y.y-=this.ty),this.tz&&(Y.z-=this.tz);var Z=this.fv/(this.fv+Y.z),X=Y.x*Z,d=-Y.y*Z;return o?(o.x=X+this.fx,o.y=d+this.fy,o.z=-Y.z,o.scaleX=Z,o.scaleY=Z,void 0):{x:X+this.fx,y:d+this.fy,z:-Y.z,scale:Z}},sortZ:function(){this.stage.children.sort(function(t,i){return t.z>i.z})},tick:function(){this.sortZ()}});return a}();return n},{requires:["hilo/core/Hilo","hilo/core/Class"]});