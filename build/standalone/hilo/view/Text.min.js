/**
 * Hilo 1.0.0 for standalone
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
!function(t){var e=t.Hilo,i=e.Class,n=e.View,l=e.CacheMixin,o=i.create({Extends:n,Mixes:l,constructor:function(t){t=t||{},this.id=this.id||t.id||e.getUid("Text"),o.superclass.constructor.call(this,t),t.font||(this.font="12px arial"),this._fontHeight=o.measureFontHeight(this.font)},text:null,color:"#000",textAlign:null,textVAlign:null,outline:!1,lineSpacing:0,maxWidth:200,font:null,textWidth:0,textHeight:0,setFont:function(t){var e=this;return e.font!==t&&(e.font=t,e._fontHeight=o.measureFontHeight(t)),e},render:function(t,e){var i=this;t.canvas;if("canvas"===t.renderType)i._draw(t.context);else if("dom"===t.renderType){var n=i.drawable,l=n.domElement,o=l.style;o.font=i.font,o.textAlign=i.textAlign,o.color=i.color,o.width=i.width+"px",o.height=i.height+"px",o.lineHeight=i._fontHeight+i.lineSpacing+"px",l.innerHTML=i.text,t.draw(this)}else i.cache(),t.draw(i)},_draw:function(t){var e=this,i=e.text.toString();if(i){t.font=e.font,t.textAlign=e.textAlign,t.textBaseline="top";var n,l,o,r=i.split(/\r\n|\r|\n|<br(?:[ \/])*>/),h=0,a=0,s=e._fontHeight+e.lineSpacing,c=[];for(n=0,len=r.length;n<len;n++)if(l=r[n],o=t.measureText(l).width,o<=e.maxWidth)c.push({text:l,y:a}),o>h&&(h=o),a+=s;else{var d,x,g,f="",u=0;for(x=0,wlen=l.length;x<wlen;x++)g=l[x],d=t.measureText(f+g).width,d>e.maxWidth?(c.push({text:f,y:a}),u>h&&(h=u),a+=s,f=g):(u=d,f+=g),x==wlen-1&&(c.push({text:f,y:a}),f!==g&&d>h&&(h=d),a+=s)}e.textWidth=h,e.textHeight=a,e.width||(e.width=h),e.height||(e.height=a);var w=0;switch(e.textVAlign){case"middle":w=e.height-e.textHeight>>1;break;case"bottom":w=e.height-e.textHeight}var m=e.background;m&&(t.fillStyle=m,t.fillRect(0,0,e.width,e.height)),e.outline?t.strokeStyle=e.color:t.fillStyle=e.color;for(var n=0;n<c.length;n++){var l=c[n];e._drawTextLine(t,l.text,w+l.y)}}},_drawTextLine:function(t,e,i){var n=this,l=0,o=n.width;switch(n.textAlign){case"center":l=o>>1;break;case"right":case"end":l=o}n.outline?t.strokeText(e,l,i):t.fillText(e,l,i)},Statics:{measureFontHeight:function(t){var i,n=document.documentElement,l=e.createElement("div",{style:{font:t,position:"absolute"},innerHTML:"M"});return n.appendChild(l),i=l.offsetHeight,n.removeChild(l),i}}});e.Text=o}(window);