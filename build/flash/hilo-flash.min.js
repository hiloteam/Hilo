/**
 * Hilo 1.0.0 for flashAdaptor
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
!function(){var t=function(){function e(t){return t.id+s++}var i=["x","y","scaleX","scaleY","rotation","visible","alpha"],a=i.concat(["pivotX","pivotY","width","height","depth"]),o=a.concat(["text","color","textAlign","outline","lineSpacing","font"]),s=0,n={View:a,Stage:i,Graphics:a,Text:o};return Hilo.Class.create({Extends:Hilo.Renderer,constructor:function(i){t.superclass.constructor.call(this,i),this.stage._ADD_TO_FLASH=!0,this.stage.fid=e(this.stage),this.stage.flashType="Stage",this.commands=i.commands||[],this.commands.push("create",this.stage.fid,"Stage"),this.commands.push("stageAddChild",this.stage.fid)},startDraw:function(t){return t==this.stage?!0:(t._lastState=t._lastState||{},t._ADD_TO_FLASH||(t._ADD_TO_FLASH=!0,t.fid=e(t),t._drawTextLine?t.flashType="Text":t.beginLinearGradientFill?t.flashType="Graphics":t==this.stage?t.flashType="Stage":t.flashType="View",this.commands.push("create",t.fid,t.flashType)),!0)},draw:function(t){if(t!=this.stage){t._lastState=t._lastState||{};var e=t._lastState.parent,i=t.parent;switch(i&&(e&&i.fid==e.fid||this.commands.push("addChild",i.fid,t.fid,t.depth)),t._lastState.parent=t.parent,t.flashType){case"Graphics":t.isDirty&&t.flashGraphicsCommands&&t.flashGraphicsCommands.length>0&&(this.commands.push("graphicsDraw",t.fid,t.flashGraphicsCommands.join(";")),t.isDirty=!1);break;case"Text":}}},transform:function(t){var e=n[t.flashType],i=t._lastState=t._lastState||{};if(e){for(var a=0,o=e.length;o>a;a++){var s=e[a],r=i[s],h=t[s];i[s]=h,r!=h&&this.commands.push("setProp",t.fid,s,h)}if(t.drawable&&t.drawable.image&&t.drawable.rect){var l=t.drawable.image,c=t.drawable.rect.join(",");c!=i.rectStr&&this.commands.push("setProp",t.fid,"rect",c),l.src!=i.imageSrc&&this.commands.push("setImage",t.fid,l.src),i.rectStr=c,i.imageSrc=l.src}var d=t.background||"undefined";"string"==typeof d&&d!=i.background&&(this.commands.push("setProp",t.fid,"background",d),i.background=d)}},remove:function(t){var e=t.parent;e&&(this.commands.push("removeChild",t.parent.fid,t.fid),t._lastState&&(t._lastState.parent=null))}})}();(function(){function e(){var t=window.event,e={rawEvent:t,type:t.type,target:t.srcElememt,preventDefault:function(){t.returnValue=!1},stopPropagation:function(){t.cancelBubble=!0}};return-1!=t.type.indexOf("mouse")?(e.clientX=t.clientX,e.clientY=t.clientY,"mouseover"==t.type?e.relatedTarget=t.fromElement:"mouseout"==t.type&&(e.relatedTarget=t.toElement)):-1!=t.type.indexOf("key")&&(e.charCode=e.keyCode=t.keyCode),e}var i=document.scripts,a=i[i.length-1],o=a.src.substring(0,a.src.lastIndexOf("/")+1),s=o+"hilo.swf",n={url:s,id:"hiloFlash",fps:60,useFlashLoad:!1,width:"100%",height:"100%"},r={},h=!1,l=[],c={init:function(t){var e={};Hilo.copy(e,n),Hilo.copy(e,window.hiloFlashOption||{}),Hilo.copy(e,t||{});!Hilo.browser.supportCanvas||e.forceFlash||location.search.indexOf("forceFlash")>-1?(Hilo.isFlash=!0,this._addFlashCallback(),this._flashShim(e)):Hilo.View.prototype.release=function(){this.removeFromParent()}},setFps:function(t){this._fps!=t&&(this._fps=t,l.push("setFps",t))},_flashShim:function(i){var a=this;document.addEventListener=document.addEventListener||function(t,e){document.attachEvent("on"+t,e)},document.removeEventListener=document.removeEventListener||function(t,e){document.detachEvent("on"+t,e)},Array.prototype.indexOf=Array.prototype.indexOf||function(t){for(var e=0,i=this.length;e>i;e++)if(this[e]===t)return e;return-1},i.useFlashLoad&&(Hilo.ImageLoader.prototype.load=function(t){var e=this;Hilo.flashLoadImage(t.src,function(t){e.onLoad(t.target)},function(){e.onError()})}),Hilo.Stage.prototype._initRenderer=function(e){var o=this.canvas;"string"==typeof o&&(o=Hilo.getElement(o)),o&&o.id&&(i.id=o.id);var s=e.container;"string"==typeof s&&(s=Hilo.getElement(s)),o&&o.parentNode&&(s=s||o.parentNode,o.parentNode.removeChild(o)),s||(s=document.body),this.canvas=s;var n=this.width,r=this.height,h=this.updateViewport();e.width||(n=h&&h.width||320),e.height||(r=h&&h.height||480),a._insertSwf(Hilo.copy(i,{container:s,width:n*(this.scaleX||1),height:r*(this.scaleY||1)}));var c={canvas:s,stage:this,commands:l};this.renderer=new t(c)},Hilo.Stage.prototype.addTo=function(t){var e=this._swf;return e&&e.parentNode!==t&&t.appendChild(e),this};var o=Hilo.Stage.prototype.enableDOMEvent;Hilo.Stage.prototype.enableDOMEvent=function(t,e){var i=this.canvas;return i.addEventListener||(i.addEventListener=function(t,e){i.attachEvent("on"+t,e)},i.removeEventListener=function(t,e){i.detachEvent("on"+t,e)}),o.call(this,t,e)};var s=Hilo.Stage.prototype._onDOMEvent;Hilo.Stage.prototype._onDOMEvent=function(t){s.call(this,t||e())},Hilo.View.prototype.release=function(){this.removeFromParent(),this.fid&&l.push("release",this.fid)},Hilo.Text.prototype.render=function(t){t.draw(this)},Hilo.Graphics.prototype.render=function(t){t.draw(this)};for(var n=["lineStyle","beginFill","endFill","beginBitmapFill","beginPath","closePath","moveTo","lineTo","quadraticCurveTo","bezierCurveTo","drawRect","drawRoundRectComplex","drawRoundRect","drawCircle","drawEllipse","cache","uncache","clear"],r=0;r<n.length;r++){var h=n[r];Hilo.Graphics.prototype[h]=function(t){return function(){var e=Array.prototype.slice.call(arguments),i=[t].concat(e).join("!");return this.flashGraphicsCommands=this.flashGraphicsCommands||[],this.flashGraphicsCommands.push(i),this.isDirty=!0,this}}(h)}Hilo.Graphics.prototype.beginRadialGradientFill=function(t,e,i,a,o,s,n,r){var h=["beginRadialGradientFill",t,e,i,a,o,s,n.join(":"),r.join(":")].join("!");return this.flashGraphicsCommands=this.flashGraphicsCommands||[],this.flashGraphicsCommands.push(h),this.isDirty=!0,this},Hilo.Graphics.prototype.beginLinearGradientFill=function(t,e,i,a,o,s){var n=["beginLinearGradientFill",t,e,i,a,o.join(":"),s.join(":")].join("!");return this.flashGraphicsCommands=this.flashGraphicsCommands||[],this.flashGraphicsCommands.push(n),this.isDirty=!0,this},Hilo.Graphics.prototype.drawSVGPath=function(t){var e=this,i=(e._addAction,t.split(/,| (?=[a-zA-Z])/));e.beginPath();for(var a=0,o=i.length;o>a;a++){var s=i[a],n=s.charAt(0).toUpperCase(),r=s.substring(1).split(/,| /);switch(0==r[0].length&&r.shift(),n){case"M":e.moveTo(r[0],r[1]);break;case"L":e.lineTo(r[0],r[1]);break;case"C":e.bezierCurveTo(r[0],r[1],r[2],r[3],r[4],r[5]);break;case"Z":e.closePath()}}return e},Hilo.WebSound.removeAudio=function(t){var e="string"==typeof t?t:t.src,i=this._audios[e];i&&(i.stop(),i.off(),i.release(),this._audios[e]=null,delete this._audios[e])},Hilo.WebAudio.isSupported=!0,Hilo.WebAudio.enabled=!0,Hilo.WebAudio.enable=function(){},Hilo.WebAudio.prototype._init=function(){this.fid=Hilo.getUid("audio"),l.push("audio","create",this.fid,this.src),this.autoPlay&&this.play()},Hilo.WebAudio.prototype.load=function(){return l.push("audio","load",this.fid),this},Hilo.WebAudio.prototype.play=function(){return l.push("audio","play",this.fid,this.loop?1:0),this},Hilo.WebAudio.prototype.pause=function(){return l.push("audio","pause",this.fid),this},Hilo.WebAudio.prototype.resume=function(){return l.push("audio","resume",this.fid),this},Hilo.WebAudio.prototype.stop=function(){return l.push("audio","stop",this.fid),this},Hilo.WebAudio.prototype.setVolume=function(t){return l.push("audio","setVolume",this.fid,t),this},Hilo.WebAudio.prototype.setMute=function(t){return l.push("audio","setMute",this.fid,t?1:0),this},Hilo.WebAudio.prototype.release=function(){return l.push("audio","release",this.fid),this}},_insertSwf:function(t){var e,i=this,a=t.url,o=t.id,s=t.color||null,n=t.fps,r=t.container,h=t.width,l=t.height;if(this.setFps(n),window.attachEvent){var c=r.innerHTML;r.innerHTML='<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="'+location.protocol+'//fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0"><param name="allowScriptAccess" value="always"><param name="flashvars" value="id='+o+'"><param name="wmode" value="transparent"><param name="bgcolor" value="'+s+'"></object>'+c;var e=r.getElementsByTagName("object")[0];e.id=e.name=o,e.movie=a}else e=document.createElement("embed"),e.setAttribute("src",a),e.setAttribute("type","application/x-shockwave-flash"),e.setAttribute("allowScriptAccess","always"),e.setAttribute("allowFullScreen","true"),e.setAttribute("bgcolor",s),e.setAttribute("pluginspage","http://www.adobe.com/go/getflashplayer_cn"),e.setAttribute("wmode","transparent"),e.setAttribute("FlashVars","debug=0"),r.appendChild(e);return e.name=o,e.width=h,e.height=l,e.id=o,this._swf=e,Hilo.Stage.prototype.tick=function(t){this.paused||(this._render(this.renderer,t),i.tick())},e},tick:function(){h&&l.length>0&&(this._swf.CallFunction('<invoke name="executeCommand" returntype="javascript"><arguments><string>'+l.join("âˆš")+"</string></arguments></invoke>"),l.length=0)},_addFlashCallback:function(t){var e=this;Hilo.__flashFireEvent=function(t,i){if(t.indexOf("key")>-1&&document.fireEvent){var a=document.createEventObject();a.keyCode=i,document.fireEvent("on"+t,a)}else e._swf&&e._swf.fireEvent&&e._swf.fireEvent("on"+t)};var i=e.__flashImageCache={},a={};Hilo.flashLoadImage=function(t,e,o){return i[t]?void e(i[t]):(r[t]=r[t]||[],r[t].push([e,o||e]),void(a[t]||(a[t]=!0,l.push("loadImage",t))))},Hilo.__flashUnlock=function(){h=!0},Hilo.__flashImageCallBack=function(t,e,a,o){var s=r[t];if(s&&s.length>0){var n={target:{src:t,width:a,height:o,isFlash:!0,tagName:"img"},errorCode:e};0==e&&(i[t]=n);for(var h=0,l=s.length;l>h;h++)s[h][e](n);s.length=0}}}};return"true"===a.getAttribute("data-auto")&&c.init(),Hilo.FlashAdaptor=c})()}();